server.port=8081
spring.application.name=api-gateway

# Eureka Client Configuration
eureka.client.service-url.defaultZone=http://eureka-server:8761/eureka/
eureka.client.fetch-registry=true
eureka.client.register-with-eureka=true
eureka.instance.prefer-ip-address=true

# Gateway Configuration
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# Simple route configuration without filters
spring.cloud.gateway.routes[0].id=authentication-service
spring.cloud.gateway.routes[0].uri=lb://authentication-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/auth/**

spring.cloud.gateway.routes[1].id=user-finance-service
spring.cloud.gateway.routes[1].uri=lb://user-finance-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/finance/**

spring.cloud.gateway.routes[2].id=goal-service
spring.cloud.gateway.routes[2].uri=lb://goal-service
spring.cloud.gateway.routes[2].predicates[0]=Path=/goals/**

spring.cloud.gateway.routes[3].id=insight-service
spring.cloud.gateway.routes[3].uri=lb://insight-service
spring.cloud.gateway.routes[3].predicates[0]=Path=/insights/**

spring.cloud.gateway.routes[4].id=analytics-service
spring.cloud.gateway.routes[4].uri=lb://insight-service
spring.cloud.gateway.routes[4].predicates[0]=Path=/analytics/**

# Direct routes for testing
spring.cloud.gateway.routes[5].id=insight-test
spring.cloud.gateway.routes[5].uri=lb://insight-service
spring.cloud.gateway.routes[5].predicates[0]=Path=/test/**

spring.cloud.gateway.routes[6].id=insight-integrated
spring.cloud.gateway.routes[6].uri=lb://insight-service
spring.cloud.gateway.routes[6].predicates[0]=Path=/integrated/**

spring.cloud.gateway.routes[7].id=recommendations-service
spring.cloud.gateway.routes[7].uri=lb://insight-service
spring.cloud.gateway.routes[7].predicates[0]=Path=/recommendations/**

# OpenAPI/Swagger Routes - Allow access to individual service docs
spring.cloud.gateway.routes[8].id=auth-service-docs
spring.cloud.gateway.routes[8].uri=lb://authentication-service
spring.cloud.gateway.routes[8].predicates[0]=Path=/v3/api-docs/authentication-service
spring.cloud.gateway.routes[8].filters[0]=RewritePath=/v3/api-docs/authentication-service, /v3/api-docs

spring.cloud.gateway.routes[9].id=finance-service-docs
spring.cloud.gateway.routes[9].uri=lb://user-finance-service
spring.cloud.gateway.routes[9].predicates[0]=Path=/v3/api-docs/user-finance-service
spring.cloud.gateway.routes[9].filters[0]=RewritePath=/v3/api-docs/user-finance-service, /v3/api-docs

spring.cloud.gateway.routes[10].id=goal-service-docs
spring.cloud.gateway.routes[10].uri=lb://goal-service
spring.cloud.gateway.routes[10].predicates[0]=Path=/v3/api-docs/goal-service
spring.cloud.gateway.routes[10].filters[0]=RewritePath=/v3/api-docs/goal-service, /v3/api-docs

spring.cloud.gateway.routes[11].id=insight-service-docs
spring.cloud.gateway.routes[11].uri=lb://insight-service
spring.cloud.gateway.routes[11].predicates[0]=Path=/v3/api-docs/insight-service
spring.cloud.gateway.routes[11].filters[0]=RewritePath=/v3/api-docs/insight-service, /v3/api-docs

# Logging
logging.level.org.springframework.cloud.gateway=DEBUG

# =============================================
# Springdoc OpenAPI (Swagger 3.0) Configuration
# =============================================
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.operations-sorter=method
springdoc.swagger-ui.tags-sorter=alpha
springdoc.swagger-ui.urls[0].name=Authentication Service
springdoc.swagger-ui.urls[0].url=/v3/api-docs/authentication-service
springdoc.swagger-ui.urls[1].name=User Finance Service
springdoc.swagger-ui.urls[1].url=/v3/api-docs/user-finance-service
springdoc.swagger-ui.urls[2].name=Goal Service
springdoc.swagger-ui.urls[2].url=/v3/api-docs/goal-service
springdoc.swagger-ui.urls[3].name=Insight Service
springdoc.swagger-ui.urls[3].url=/v3/api-docs/insight-service

# =============================================
# Prometheus / Actuator Configuration
# =============================================
management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=true
management.endpoint.prometheus.enabled=true